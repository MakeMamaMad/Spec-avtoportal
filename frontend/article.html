<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Статья</title>
  <link rel="stylesheet" href="./tokens.css">
  <link rel="stylesheet" href="./base.css">
  <link rel="stylesheet" href="./components.css">

  <!-- Страхующие базовые стили (не мешают твоим) -->
  <style>
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:#fff;color:#0f172a}
    .container{max-width:1200px;margin:0 auto;padding:24px}
    .title{font-size:28px;line-height:1.25;font-weight:800;margin:0 0 6px}
    .meta{color:#64748b;font-size:13px;display:flex;gap:6px;align-items:center;margin:8px 0 12px}
    .cover{margin:12px 0 14px;border-radius:14px;overflow:hidden;background:#f2f4f7}
    .cover img{width:100%;height:auto;display:block}
    .lead{font-size:18px;line-height:1.6;margin:16px 0 8px}
    .actions{margin:16px 0 8px;display:flex;gap:10px;flex-wrap:wrap}
    .btn{display:inline-block;padding:10px 14px;border:1px solid #e5e7eb;border-radius:10px;text-decoration:none;color:#111827;background:#fff}
  </style>
  <!-- Fix absolute /urls on GitHub Pages project site -->
<script>
(function() {
  // Работать только на *.github.io
  if (!location.hostname.endsWith('github.io')) return;

  // Имя репо: /Spec-avtoportal/...  -> 'Spec-avtoportal'
  var repo = location.pathname.split('/')[1] || '';
  if (!repo) return;
  var prefix = '/' + repo;

  function fixUrl(u) {
    // Чиним только абсолютные пути вида "/something"
    return (typeof u === 'string' && u.startsWith('/')) ? (prefix + u) : u;
  }

  // Прогоняем <link>, <script>, <img> — сразу (до загрузки стилей)
  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('link[href]').forEach(function(el){
      el.href = fixUrl(el.getAttribute('href'));
    });
    document.querySelectorAll('script[src]').forEach(function(el){
      el.src = fixUrl(el.getAttribute('src'));
    });
    document.querySelectorAll('img[src]').forEach(function(el){
      el.src = fixUrl(el.getAttribute('src'));
    });
  });

  // Хелпер для JS (fetch и т.п.)
  window.fixPath = function(p){ return fixUrl(p); };
})();
</script>

  <script>
    // 1) Подтягиваем с главной ВСЕ <link rel="stylesheet">,
    // 2) и сам <header> (точно такой же, как на index.html).
    (async () => {
      try {
        const res = await fetch('index.html', { cache: 'no-store' });
        const html = await res.text();
        const doc  = new DOMParser().parseFromString(html, 'text/html');

        // Переносим стили с главной, если вдруг не подключены
        doc.querySelectorAll('link[rel="stylesheet"]').forEach(link => {
          const href = link.getAttribute('href');
          if (href && ![...document.querySelectorAll('link[rel="stylesheet"]')]
              .some(l => l.getAttribute('href') === href)) {
            const clone = link.cloneNode(true);
            document.head.appendChild(clone);
          }
        });

        // Вставляем header из главной
        const h = doc.querySelector('header');
        if (h) {
          const placeholder = document.getElementById('header-placeholder');
          placeholder.replaceWith(h);
        }
      } catch (e) {
        console.warn('Header/CSS copy failed:', e);
      }
    })();
  </script>
</head>
<body>
  <!-- сюда «прилетит» точный header из index.html -->
  <header id="header-placeholder"></header>

  <div class="container">
    <main id="post"></main>
    <div id="nf" hidden>Новость не найдена</div>

    <div id="bottom-actions" class="actions" hidden>
      <a id="back-to-feed" class="btn" href="index.html">← Вернуться к ленте</a>
      <!-- сюда динамически добавлю «Читать в источнике» -->
      <a id="read-source" class="btn" href="#" target="_blank" rel="noopener" hidden>Читать в источнике ↗</a>
    </div>
  </div>


<script>
  document.getElementById('back-to-feed')?.addEventListener('click', function (e) {
    e.preventDefault();
    // Жёсткий переход без BFCache — сразу видим ленту
    location.replace('index.html?ts=' + Date.now());
  });
</script>
  <script type="module" src="./main.js"></script>
  <script type="module" src="./article.js"></script>

</body>
</html>
